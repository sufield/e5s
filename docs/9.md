Overall this reads well and is mostly correct, but a few things are inconsistent or likely to bite you. Hereâ€™s what to fix.

## âœ… Solid parts

* Examples for server and raw-SDK client are correct (Workload API socket, `tlsconfig.MTLSClientConfig`, TLS 1.3 min).
* Clear separation of domain/ports/adapters and the â€œin-memoryâ€ vs â€œreal SPIREâ€ narrative.
* Config sections and timeout defaults look reasonable.

## âš ï¸ Corrections & clarifications

1. **Selector type definition is inconsistent with your domain model**

   * Earlier docs (and your code diffs) show `Selector` as `type/key/value` with formatted `"type:key:value"`.
   * In this page you show:

     ```go
     type Selector struct {
       selectorType string  // e.g., "unix"
       selectorValue string // e.g., "uid:1000"
     }
     ```
   * **Fix:** Align to the 3-field model you actually use:

     ```go
     type Selector struct {
       selectorType SelectorType // e.g., "unix" | "workload" | "k8s"
       key          string       // e.g., "uid"
       value        string       // e.g., "1000"  (value MAY contain colons)
       formatted    string       // cached "type:key:value"
     }
     ```

2. **Directory structure vs. adapter status**

   * You list an outbound `httpclient` adapter in the â€œInterfacesâ€ diagram and earlier docs, but here you also say itâ€™s â€œplannedâ€.
   * **Fix:** Keep the structure without `httpclient` until it exists, and explicitly call out itâ€™s planned:

     ```
     â””â”€â”€ adapters/
         â”œâ”€â”€ inbound/identityserver   # implemented
         â””â”€â”€ outbound/
             â”œâ”€â”€ spire                # implemented
             â”œâ”€â”€ inmemory             # implemented
             â””â”€â”€ httpclient           # planned
     ```

3. **Config validation rule (â€œexactly one of AllowedPeerID or AllowedTrustDomainâ€)**

   * Thatâ€™s fine **if** your adapter enforces it. If your code hasnâ€™t implemented that validation yet, either implement it or relax the doc.
   * Many users like allowing **both** (intersection) or a clear precedence (e.g., `AllowedPeerID` takes precedence over trust domain). If you stick with â€œexactly oneâ€, keep it explicit here and in the code.

4. **Go version claims**

   * You mention Go **1.25.x** in a few places across your docs. If your `go.mod` isnâ€™t at 1.25 (most projects are 1.21â€“1.23 today), update the doc to the actual version you build/test with.
   * Also your container examples used `golang:1.25` previouslyâ€”make sure those match your real CI images.

5. **Socket path note**

   * Your server example uses `unix:///tmp/spire-agent/public/api.sock`. In many Kubernetes SPIRE deployments the agent socket is mounted at `/run/spire/sockets/agent.sock`. Since your Minikube infra uses `/tmp/spire-agent/public/api.sock`, call that out clearly as â€œfor this repoâ€™s Minikube setupâ€ and add a parenthetical for the common default in other clusters.

6. **Identity extraction helper location**

   * You reference `internal/ports/identity.go`. Elsewhere you said â€œtypes.goâ€. Pick one and keep it consistent. (The API sample uses `ports.IdentityFrom`; make sure thatâ€™s really exported from `identity.go`.)

7. **Security wording**

   * Saying â€œGoâ€™s secure cipher suites usedâ€ is fine, but technically once you set `MinVersion = tls.VersionTLS13`, the cipher suites are negotiated by TLS 1.3 (not the Go 1.2 suites list). Maybe rephrase to: â€œTLS 1.3 enforced; cipher suites negotiated per TLS 1.3.â€

8. **IdentityDocument private key note**

   * Good that you flag it for removal. Add one short line under â€œSPIRE Integrationâ€ that adapters own the signer when you make the change, so downstream users wonâ€™t rely on `doc.PrivateKey()`.

## ğŸ”§ Minor polish

* In the client example you create `serverID` with `AuthorizeID(serverID)` and call `https://localhost:8443/...`. Thatâ€™s correct (SPIFFE verify bypasses DNS name matching), but you might add one comment explaining that hostname â‰  SAN is fine with SPIFFE authorization.
* Under â€œRun mTLS Server Exampleâ€, you export `SPIRE_AGENT_SOCKET` but your server example configures `cfg.WorkloadAPI.SocketPath` directly; note that your adapter will read from config, not the env var, unless you support env fallbacks. Either:

  * add a line showing how env is plumbed into `cfg`, or
  * change the example to set `cfg.WorkloadAPI.SocketPath` explicitly rather than exporting the env var.

---

If you make the selector fix, align the directory/adapters list, and confirm the config validation + Go version, this doc will be accurate and tight.
